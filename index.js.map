{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// pixabay-api.js\nimport axios from 'axios';\n\n\nconst API_KEY = '53389210-1518ce0ab28dfc8ed2510f80a';\nconst per_page = 15;\n\nconst pixabayInstance = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  timeout: 10000,\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page,\n  },\n});\n\nexport async function getImagesByQuery(query, page = 1) {\n  if (!query || typeof query !== 'string') {\n    throw new Error('Query must be a non-empty string');\n  }\n  try {\n    const response = await pixabayInstance.get('', {\n      params: {\n        q: query,\n        page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport { per_page };\n","// render-functions.js\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images = []) {\n  if (!refs.gallery) return;\n\n  const markup = images\n    .map(\n      img => `\n    <div class=\"photo-card\">\n      <a href=\"${img.largeImageURL}\">\n        <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\"><b>Likes</b><span>${img.likes}</span></p>\n        <p class=\"info-item\"><b>Views</b><span>${img.views}</span></p>\n        <p class=\"info-item\"><b>Comments</b><span>${img.comments}</span></p>\n        <p class=\"info-item\"><b>Downloads</b><span>${img.downloads}</span></p>\n      </div>\n    </div>`\n    )\n    .join('');\n\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  if (!refs.gallery) return;\n  refs.gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  if (!refs.loader) return;\n  refs.loader.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  if (!refs.loader) return;\n  refs.loader.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n  if (!refs.loadMoreBtn) return;\n  refs.loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  if (!refs.loadMoreBtn) return;\n  refs.loadMoreBtn.classList.add('is-hidden');\n}\n\nexport const domRefs = refs;\n","// main.js\nimport { getImagesByQuery, per_page } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  domRefs,\n} from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\n\nconst formEl = document.querySelector('#search-form');\nconst loadMoreBtn = domRefs.loadMoreBtn;\nconst galleryEl = domRefs.gallery;\n\nhideLoadMoreButton();\nhideLoader();\n\nif (formEl) {\n  formEl.addEventListener('submit', async (e) => {\n    e.preventDefault();\n\n    const formData = new FormData(formEl);\n    const query = (formData.get('searchQuery') || '').trim();\n\n    if (!query) {\n      iziToast.warning({ title: 'Warning', message: 'Please enter a search query.' });\n      return;\n    }\n\n    currentQuery = query;\n    currentPage = 1;\n    clearGallery();\n    hideLoadMoreButton();\n    showLoader();\n\n    try {\n      const data = await getImagesByQuery(currentQuery, currentPage);\n      totalHits = data.totalHits || 0;\n      const hits = data.hits || [];\n\n      if (totalHits === 0 || hits.length === 0) {\n        iziToast.error({ title: 'No results', message: 'No images found. Try another query.' });\n        hideLoader();\n        return;\n      }\n\n      createGallery(hits);\n\n      iziToast.success({\n        title: 'Success',\n        message: `Hooray! We found ${totalHits} images.`,\n      });\n\n      if (currentPage * per_page < totalHits) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n        iziToast.info({ title: 'End', message: \"We're sorry, but you've reached the end of search results.\" });\n      }\n    } catch (err) {\n      console.error(err);\n      iziToast.error({ title: 'Error', message: 'Something went wrong while fetching images.' });\n    } finally {\n      hideLoader();\n    }\n  });\n}\n\nif (loadMoreBtn) {\n  loadMoreBtn.addEventListener('click', async () => {\n    if (!currentQuery) return;\n\n    showLoader();\n    hideLoadMoreButton();\n\n    currentPage += 1;\n\n    try {\n      const data = await getImagesByQuery(currentQuery, currentPage);\n      const hits = data.hits || [];\n      totalHits = data.totalHits || totalHits;\n\n      if (hits.length === 0) {\n        iziToast.info({ title: 'End', message: \"We're sorry, but you've reached the end of search results.\" });\n        hideLoadMoreButton();\n        return;\n      }\n\n      createGallery(hits);\n\n      const firstCard = galleryEl.querySelector('.photo-card');\n      if (firstCard) {\n        const { height } = firstCard.getBoundingClientRect();\n        window.scrollBy({\n          top: height * 2,\n          behavior: 'smooth',\n        });\n      }\n\n      if (currentPage * per_page < totalHits) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n        iziToast.info({ title: 'End', message: \"We're sorry, but you've reached the end of search results.\" });\n      }\n    } catch (err) {\n      console.error(err);\n      iziToast.error({ title: 'Error', message: 'Failed to load more images.' });\n      currentPage = Math.max(1, currentPage - 1);\n      showLoadMoreButton();\n    } finally {\n      hideLoader();\n    }\n  });\n}\n\nconst params = new URLSearchParams(window.location.search);\nconst initialQuery = params.get('searchQuery');\n\nif (initialQuery) {\n  formEl.searchQuery.value = initialQuery;\n  formEl.dispatchEvent(new Event('submit'));\n}"],"names":["API_KEY","per_page","pixabayInstance","axios","getImagesByQuery","query","page","error","refs","lightbox","SimpleLightbox","createGallery","images","markup","img","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","domRefs","currentQuery","currentPage","totalHits","formEl","loadMoreBtn","galleryEl","e","iziToast","data","hits","err","firstCard","height","params","initialQuery"],"mappings":"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"}